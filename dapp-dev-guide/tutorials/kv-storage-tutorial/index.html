<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<title data-rh="true">Key-Value Storage Tutorial | Casper</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://operators.casper.network//dapp-dev-guide/tutorials/kv-storage-tutorial/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Key-Value Storage Tutorial | Casper"><meta data-rh="true" name="description" content="This tutorial covers a simple contract, which creates a key that stores a CLType value. This example will show you how to store a U64, string, account hash, or U512 value."><meta data-rh="true" property="og:description" content="This tutorial covers a simple contract, which creates a key that stores a CLType value. This example will show you how to store a U64, string, account hash, or U512 value."><link data-rh="true" rel="icon" href="/image/favicon.ico"><link data-rh="true" rel="canonical" href="https://operators.casper.network//dapp-dev-guide/tutorials/kv-storage-tutorial/"><link data-rh="true" rel="alternate" href="https://operators.casper.network//dapp-dev-guide/tutorials/kv-storage-tutorial/" hreflang="en"><link data-rh="true" rel="alternate" href="https://operators.casper.network//dapp-dev-guide/tutorials/kv-storage-tutorial/" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.601f6aec.css">
<link rel="preload" href="/assets/js/runtime~main.10076db6.js" as="script">
<link rel="preload" href="/assets/js/main.757c0648.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/icon/logo-dark.svg" alt="Casper Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/icon/logo-white.svg" alt="Casper Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title"></b></a><a class="navbar__item navbar__link" href="/workflow/">How To&#x27;s</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/dapp-dev-guide/">Developers</a><a class="navbar__item navbar__link" href="/operators/">Operators</a><a class="navbar__item navbar__link" href="/design/">Design</a><a class="navbar__item navbar__link" href="/economics/">Economics</a><a class="navbar__item navbar__link" href="/staking/">Staking</a><a class="navbar__item navbar__link" href="/glossary/">Glossary</a><a class="navbar__item navbar__link" href="/faq/">FAQ</a><a href="https://discord.gg/casperblockchain" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Chat<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_dNtB"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg><span>English</span></span></a><ul class="dropdown__menu"><li><a href="/dapp-dev-guide/tutorials/kv-storage-tutorial/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">English</a></li></ul></div><a href="https://github.com/casper-network/docs-app" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_S7eR toggle_TdHA toggleDisabled_f9M3"><div class="toggleButton_rCf9" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" class="toggleScreenReader_g2nN" aria-label="Switch between dark and light mode (currently light mode)"></div><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dapp-dev-guide/">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dapp-dev-guide/why-build-on-casper/">Why Build on Casper</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dapp-dev-guide/list-cspr/">Listing CSPR</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dapp-dev-guide/getting-started/">Getting Started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/writing-contracts/">Writing Smart Contracts</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dapp-dev-guide/testing/">Testing Contracts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dapp-dev-guide/setup-nctl/">Local Network Testing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dapp-dev-guide/upgrading-contracts/">Upgrading Contracts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dapp-dev-guide/deploying-contracts/">Deploying Contracts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dapp-dev-guide/calling-contracts/">Calling Contracts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dapp-dev-guide/execution-error-codes/">Execution Error Codes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dapp-dev-guide/keys/">Accounts and Cryptographic Keys</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dapp-dev-guide/understanding-hash-types/">Understanding Hash Types</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/sdk/">SDK Client Libraries</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/tutorials/">Tutorials</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/counter/">A Counter Contract Tutorial</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/erc20/">ERC-20 Tutorial</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/dapp-dev-guide/tutorials/cep47/">CEP-47 Tutorial</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/dapp-dev-guide/tutorials/kv-storage-tutorial/">Key-Value Storage Tutorial</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/multi-sig/">Multi-Signature Tutorial</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dapp-dev-guide/tutorials/transfer-token-to-contract/">Safely Transfer Tokens to a Contract</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dapp-dev-guide/tutorials/upgrade-tutorial/">Smart Contract Upgrade Tutorial</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dapp-dev-guide/tutorials/casper-signer/">Casper Signer in a dApp</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_cwdi"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_xORG"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/">üè†</a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link breadcrumbsItemLink_e5ie">Tutorials</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/dapp-dev-guide/tutorials/kv-storage-tutorial/">Key-Value Storage Tutorial</a></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Key-Value Storage Tutorial</h1><p>This tutorial covers a simple contract, which creates a key that stores a <code>CLType</code> value. This example will show you how to store a <em>U64</em>, <em>string</em>, <em>account hash</em>, or <em>U512</em> value.</p><p>The code is available in the <a href="https://github.com/casper-ecosystem/kv-storage-contract" target="_blank" rel="noopener noreferrer">Casper Ecosystem GitHub</a>. Or, you can get started in <a href="https://gitpod.io/#https://github.com/casper-ecosystem/kv-storage-contract" target="_blank" rel="noopener noreferrer">GitPod</a>.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="the-contract">The Contract<a class="hash-link" href="#the-contract" title="Direct link to heading">‚Äã</a></h2><p>Let&#x27;s start by understanding the structure of the contract itself. Here we create a contract and name it <code>kvstorage_contract</code>. The contract package will be stored under this name on the blockchain. Since the key-value contract is slightly stateless, initialization is not required.</p><div class="codeBlockContainer_I0IT language-rust theme-code-block"><div class="codeBlockContent_wNvx rust"><pre tabindex="0" class="prism-code language-rust codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">#[no_mangle]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> pub extern &quot;C&quot; fn store_u64() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     let name: String = runtime::get_named_arg(&quot;name&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     let value: u64 = runtime::get_named_arg(&quot;value&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     set_key(name.as_str(), value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> #[no_mangle]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> pub extern &quot;C&quot; fn store_u512() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     let name: String = runtime::get_named_arg(&quot;name&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     let value: U512 = runtime::get_named_arg(&quot;value&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     set_key(name.as_str(), value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> #[no_mangle]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> pub extern &quot;C&quot; fn store_string() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     let name: String = runtime::get_named_arg(&quot;name&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     let value: String = runtime::get_named_arg(&quot;value&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     set_key(name.as_str(), value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> #[no_mangle]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> pub extern &quot;C&quot; fn store_account_hash() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     let name: String = runtime::get_named_arg(&quot;name&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     let value: AccountHash = runtime::get_named_arg(&quot;value&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     set_key(name.as_str(), value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> #[no_mangle]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> pub extern &quot;C&quot; fn store_bytes() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     let name: String = runtime::get_named_arg(&quot;name&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     let value: Vec&lt;u8&gt; = runtime::get_named_arg(&quot;value&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     set_key(name.as_str(), value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> #[no_mangle]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> pub extern &quot;C&quot; fn call() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     let (contract_package_hash, _) = storage::create_contract_package_at_hash();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     let mut entry_points = EntryPoints::new();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     entry_points.add_entry_point(EntryPoint::new(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         String::from(&quot;store_u64&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         vec![</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             Parameter::new(&quot;name&quot;, CLType::String),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             Parameter::new(&quot;value&quot;, CLType::U64),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         CLType::Unit,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         EntryPointAccess::Public,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         EntryPointType::Contract,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     ));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     entry_points.add_entry_point(EntryPoint::new(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         String::from(&quot;store_u512&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         vec![</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             Parameter::new(&quot;name&quot;, CLType::String),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             Parameter::new(&quot;value&quot;, CLType::U512),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         CLType::Unit,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         EntryPointAccess::Public,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         EntryPointType::Contract,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     ));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     entry_points.add_entry_point(EntryPoint::new(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         String::from(&quot;store_string&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         vec![</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             Parameter::new(&quot;name&quot;, CLType::String),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             Parameter::new(&quot;value&quot;, CLType::String),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         CLType::Unit,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         EntryPointAccess::Public,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         EntryPointType::Contract,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     ));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     entry_points.add_entry_point(EntryPoint::new(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         String::from(&quot;store_account_hash&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         vec![</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             Parameter::new(&quot;name&quot;, CLType::String),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             Parameter::new(&quot;value&quot;, AccountHash::cl_type()),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         CLType::Unit,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         EntryPointAccess::Public,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         EntryPointType::Contract,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     ));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     entry_points.add_entry_point(EntryPoint::new(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         String::from(&quot;store_bytes&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         vec![</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             Parameter::new(&quot;name&quot;, CLType::String),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             Parameter::new(&quot;value&quot;, CLType::List(Box::new(CLType::U8))),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         CLType::Unit,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         EntryPointAccess::Public,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         EntryPointType::Contract,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     ));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     let (contract_hash, _) =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         storage::add_contract_version(contract_package_hash, entry_points, Default::default());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     runtime::put_key(&quot;kvstorage_contract&quot;, contract_hash.into());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     let contract_hash_pack = storage::new_uref(contract_hash);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     runtime::put_key(&quot;kvstorage_contract_hash&quot;, contract_hash_pack.into())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> fn set_key&lt;T: ToBytes + CLTyped&gt;(name: &amp;str, value: T) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     match runtime::get_key(name) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         Some(key) =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             let key_ref = key.try_into().unwrap_or_revert();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             storage::write(key_ref, value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         None =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             let key = storage::new_uref(value).into();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             runtime::put_key(name, key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="testing-the-contract">Testing the Contract<a class="hash-link" href="#testing-the-contract" title="Direct link to heading">‚Äã</a></h2><p>The Casper Contracts SDK supports local testing of smart contracts. This tutorial will cover how to test the U64 key-value function, which you can adapt for other types.</p><p>To test the contract, you need to deploy the contract and store the value on chain. Here is some sample code to accomplish these steps:</p><div class="codeBlockContainer_I0IT language-rust theme-code-block"><div class="codeBlockContent_wNvx rust"><pre tabindex="0" class="prism-code language-rust codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">impl KVstorageContract{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   pub fn deploy() -&gt; Self {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       // build the test context with the account for the deploy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let mut context = TestContextBuilder::new()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .with_account(TEST_ACCOUNT, U512::from(128_000_000))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       // specify the session code &amp; build the deploy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let session_code = Code::from(&quot;contract.wasm&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let session = SessionBuilder::new(session_code, runtime_args! {})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .with_address(TEST_ACCOUNT)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .with_authorization_keys(&amp;[TEST_ACCOUNT])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        context.run(session);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let kvstorage_hash = Self::contract_hash(&amp;context, KV_STORAGE_HASH);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Self {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            context,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            kvstorage_hash,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // query the contract hash after the deploy is complete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pub fn contract_hash(context: &amp;TestContext, name: &amp;str) -&gt; Hash {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        context</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .query(TEST_ACCOUNT, &amp;[name])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .unwrap_or_else(|_| panic!(&quot;{} contract not found&quot;, name))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .into_t()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .unwrap_or_else(|_| panic!(&quot;{} is not a type Contract.&quot;, name))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // store the u_64 value in the global state</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pub fn call_store_u64(&amp;mut self, name: String, value: u64) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let code = Code::Hash(self.kvstorage_hash, &quot;store_u64&quot;.to_string());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let args = runtime_args! {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;name&quot; =&gt; name,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;value&quot; =&gt; value,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let session = SessionBuilder::new(code, args)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .with_address(TEST_ACCOUNT)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .with_authorization_keys(&amp;[TEST_ACCOUNT])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self.context.run(session);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="write-unit-tests">Write Unit Tests<a class="hash-link" href="#write-unit-tests" title="Direct link to heading">‚Äã</a></h3><p>With these functions in place, it&#x27;s possible to start writing tests for the contract.</p><div class="codeBlockContainer_I0IT language-rust theme-code-block"><div class="codeBlockContent_wNvx rust"><pre tabindex="0" class="prism-code language-rust codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">mod tests {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[test]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fn should_store_u64() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        const KEY_NAME: &amp;str = &quot;test_u64&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let mut kv_storage = KVstorageContract::deploy();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let name = String::from(&quot;test_u64&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let value: u64 = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        kv_storage.call_store_u64(name, value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let check: u64 = kv_storage.query_contract(&amp;KEY_NAME).unwrap();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assert_eq!(value, check);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   // A test to check whether the value is updated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   #[test]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fn should_update_u64() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        const KEY_NAME: &amp;str = &quot;testu64&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let mut kv_storage = KVstorageContract::deploy();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let original_value: u64 = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let updated_value: u64 = 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        kv_storage.call_store_u64(KEY_NAME.to_string(), original_value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        kv_storage.call_store_u64(KEY_NAME.to_string(), updated_value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let value: u64 = kv_storage.query_contract(&amp;KEY_NAME).unwrap();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assert_eq!(value, 2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="running-locally">Running Locally<a class="hash-link" href="#running-locally" title="Direct link to heading">‚Äã</a></h3><p>You can run unit tests locally if you have set up the contract using <em>cargo-casper</em> as shown in the <a href="/dapp-dev-guide/getting-started/">Getting started</a> guide.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">cargo </span><span class="token builtin class-name">test</span><span class="token plain"> -p tests</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="deploying-to-the-testnet-and-interacting-with-the-contract">Deploying to the Testnet and Interacting with the Contract<a class="hash-link" href="#deploying-to-the-testnet-and-interacting-with-the-contract" title="Direct link to heading">‚Äã</a></h2><p>When working with the testnet, create an account on <a href="https://testnet.cspr.live" target="_blank" rel="noopener noreferrer">Testnet CSPR Live</a> and fund it using the faucet. Download the private key and use the key to sign the deployment. It&#x27;s possible to create keys using the rust client as well.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="deploy-the-contract">Deploy the Contract<a class="hash-link" href="#deploy-the-contract" title="Direct link to heading">‚Äã</a></h3><p>After compiling the contract, you need to deploy the compiled WASM to the network. This action installs the contract in the blockchain.</p><p>The following example shows you how to use the Casper client to retrieve the contract session hash and the block hash where the contract is deployed. The paths for the <em>secret-key</em> and <em>session-path</em> are relative to your system. You need to specify the paths on your machine to run the command.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">casper-client put-deploy </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --chain-name </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">CHAIN-NAME</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --node-address http://</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">HOST</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">:</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">PORT</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --secret-key </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token environment constant" style="color:#36acaa">PATH</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/secretkey.pem </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --session-path  </span><span class="token environment constant" style="color:#36acaa">$HOME</span><span class="token plain">/kv-storage-contract/target/wasm32-unknown-unknown/release/contract.wasm </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --payment-amount </span><span class="token number" style="color:#36acaa">1000000000000</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p><strong>Query the Account &amp; Get the Contract Hash</strong></p><p>The internal state of the blockchain is updated via a series of steps (blocks). All blockchain queries must include a [<em>global state hash</em> which corresponds to the block hash or height of the blockchain. Visit <a href="/dapp-dev-guide/getting-started/#querying-global-state-for-the-address-of-a-contract">Querying the address of a contract</a>.</p><p><strong>Invoke an Entry Point &amp; Set a value</strong></p><p>Once the contract is deployed, you can create another deploy, which calls one of the entry points within the contract. You must know the entry point&#x27;s name or the session hash retrieved in the previous step to call an entry point. The command below shows you how to do this. The <em>session-path</em> is relative to your system. Specify the path on your machine and then run the command.</p><p>The kv-client has four distinct commands to set key-values for U64, string, U512, and account hash. In this example, we will use a String.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">casper-client put-deploy </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --session-name kvstorage_contract </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --session-entry-point store_string </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --session-arg</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">name:</span><span class="token string" style="color:#e3116c">&quot;string=&#x27;test&#x27;&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --session-arg</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">value:</span><span class="token string" style="color:#e3116c">&quot;string=&#x27;your test string here&#x27;&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --payment-amount </span><span class="token number" style="color:#36acaa">100000000000</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --chain-name </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">CHAIN-NAME</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --node-address http://</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">HOST</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">:</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">PORT</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --secret-key </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token environment constant" style="color:#36acaa">PATH</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/secretkey.pem</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>If the deploy works, a you will see a similar response:</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;api_version&quot;</span><span class="token builtin class-name">:</span><span class="token string" style="color:#e3116c">&quot;1.0.0&quot;</span><span class="token plain">,</span><span class="token string" style="color:#e3116c">&quot;deploy_hash&quot;</span><span class="token builtin class-name">:</span><span class="token string" style="color:#e3116c">&quot;8c3068850354c2788c1664ac6a275ee575c8823676b4308851b7b3e1fe4e3dcc&quot;</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="query-the-contract-on-chain">Query the Contract On Chain<a class="hash-link" href="#query-the-contract-on-chain" title="Direct link to heading">‚Äã</a></h3><p>Contracts can be executed under different contexts. In this example, when the contract is deployed, it runs in the context of a <code>Contract</code> and not a <code>Session</code>. This means that all stored keys are not stored under the account hash, but within the context of the contract. Therefore, when we query to retrieve the value under a key, we are querying <code>AccountHash/kvstorage_contract/&lt;key-name&gt;</code> and not just <code>AccountHash/&lt;key-name&gt;</code>.</p><p>It would be best if you first found the block hash for the block that contains your deploy. Once you have the requisite block hash, you can use the Casper client to retrieve the session hash.</p><p>Reading a value is simple; we obtain the block hash under which the value is stored, and then using that block hash, we use the <code>query-global-state</code> command to retrieve the value stored under a named key.</p><p>An example global state query looks like this:</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">casper-client query-global-state --node-address http://</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">HOST</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">:</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">PORT</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> -k </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">PUBLIC_KEY_AS_HEX</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> -g GLOBAL_STATE_HASH </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> jq -r</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Please reference the <a href="/dapp-dev-guide/getting-started/#querying-global-state-for-the-address-of-a-contract">Querying Section</a> for more details.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/casper-network/docs/tree/main/source/docs/casper/dapp-dev-guide/tutorials/kv-storage-tutorial.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/dapp-dev-guide/tutorials/cep47/test/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Testing Framework</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/multi-sig/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Introduction</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-contract" class="table-of-contents__link toc-highlight">The Contract</a></li><li><a href="#testing-the-contract" class="table-of-contents__link toc-highlight">Testing the Contract</a><ul><li><a href="#write-unit-tests" class="table-of-contents__link toc-highlight">Write Unit Tests</a></li><li><a href="#running-locally" class="table-of-contents__link toc-highlight">Running Locally</a></li></ul></li><li><a href="#deploying-to-the-testnet-and-interacting-with-the-contract" class="table-of-contents__link toc-highlight">Deploying to the Testnet and Interacting with the Contract</a><ul><li><a href="#deploy-the-contract" class="table-of-contents__link toc-highlight">Deploy the Contract</a></li><li><a href="#query-the-contract-on-chain" class="table-of-contents__link toc-highlight">Query the Contract On Chain</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright"><div class="footer-inner-container">
    <div class="footer-top">
        <ul class="items">
            <li><a href="https://arxiv.org/pdf/2101.02159.pdf" target="_blank" rel="noopener">White Paper</a></li>
            <li>
                <a href="https://docs.casperlabs.io" target="_blank" rel="noopener"> Docs </a>
            </li>
            <li><a href="https://devxdao.com/" target="_blank" rel="noopener">Grant Program</a></li>
            <li><a href="https://casper.network/network/casper-association" target="_blank" rel="noopener">Casper Association</a></li>
        </ul>
    </div>
    <div class="footer-bottom">
        <ul class="items left">
            <li>
                <a href="https://casper.network/en/network" target="_blank" rel="noopener">
                    <img class="footer-logo" src="/icon/logo-white.svg" alt="Casper Logo">
                </a>
            </li>
            <li>¬© 2021 Casper Association</li>
        </ul>
        <ul class="items right">
            <li class="trademark">
                <a href="https://casper.network/network/trademark-policy" target="_blank" rel="noopener">Trademark Policy and Guidelines</a>
            </li>
        </ul>
    </div>
</div>
</div></div></div></footer></div>
<script src="/assets/js/runtime~main.10076db6.js"></script>
<script src="/assets/js/main.757c0648.js"></script>
</body>
</html>